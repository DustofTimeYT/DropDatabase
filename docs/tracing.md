# Трассировка требований

### От бизнес-целей к функциональным требованиям

| Функциональные требования                                   | Связь с бизнес-целью                                                                                                |
| :---------------------------------------------------------- | :------------------------------------------------------------------------------------------------------------------ |
| **Для цели: Достичь 1 млн+ пользователей за год**           |                                                                                                                     |
| Создать публикацию                                          | Основная функция платформы, привлекает создателей контента - ключевой драйвер роста                                 |
| Прикрепить изображения к публикации                         | Улучшает качество контента, повышает вовлеченность                                                                  |
| Назначить тег                                               | Упрощает поиск и категоризацию, повышает полезность платформы                                                       |
| Добавить описание к публикации                              | Повышает информативность и SEO, улучшает видимость контента                                                         |
| Пометить публикацию как удаленную                           | Дает пользователям контроль над контентом, повышает доверие                                                          |
| Уведомить о комментарии                                     | Повышает вовлеченность, стимулирует возврат пользователей                                                           |
| Уведомить об upvote                                         | Поощряет создателей контента через позитивную обратную связь                                                        |
| Уведомить о результатах конкурса                            | Поддерживает активность и вовлеченность в платформенные мероприятия                                                  |
| Создать альбом                                              | Улучшает организацию контента и пользовательский опыт                                                                |
| Редактировать альбом                                        | Повышает удовлетворенность пользователей                                                                             |
| Удалить альбом                                              | Дает пользователям контроль над контентом                                                                            |
| Добавить изображения в альбом                               | Увеличивает объем и ценность пользовательского контента                                                              |
| Искать по тегам                                             | Ключевая функция для обнаружения контента, удерживает пользователей                                                  |
| Подбирать аналогичные изображения                           | Увеличивает время пребывания и вовлеченность через персонализацию                                                    |
| Ограничивать неуместный контент (18+)                       | Обеспечивает безопасную среду, критично для массовой аудитории                                                       |
| Добавить в понравившиеся                                    | Улучшает персонализацию и связь пользователя с платформой                                                            |
| Скачать изображение                                         | Повышает ценность платформы как источника контента                                                                   |
| Добавить водяной знак                                       | Поддерживает модель монетизации через подписки                                                                       |
| Отправить жалобу                                            | Поддерживает качество и безопасность платформы                                                                       |
| Отправить картинку на конкурс                               | Привлекает новых участников, увеличивает активность                                                                  |
| Отобразить результаты конкурса                              | Поддерживает интерес к платформенным активностям                                                                     |
| Выдать подписку                                             | Обеспечивает финансирование развития и маркетинга                                                                    |
| Продлить подписку                                           | Удерживает платящих пользователей, обеспечивает стабильный доход                                                     |
| Отменить подписку                                           | Поддерживает лояльность через гибкость условий                                                                       |
| Учесть оценку                                               | Мотивирует авторов и улучшает рекомендательную систему                                                               |
| Добавить комментарий                                        | Ключевой фактор социального взаимодействия и удержания                                                               |
| Создать аккаунт                                             | Базовое требование для участия и персонализации                                                                      |
| Войти в аккаунт                                             | Обеспечивает постоянный доступ к платформе                                                                           |
| Принять донат                                               | Обеспечивает дополнительное финансирование для роста                                                                 |
| Отображать контекстную рекламу                              | Основной источник дохода для финансирования роста                                                                    |
| Настройка параметров рекламы                                | Повышает эффективность рекламы, привлекает рекламодателей                                                            |
| Сбор и отображение статистики рекламы                       | Удерживает рекламодателей через демонстрацию эффективности                                                           |
| Пометить пользователя как заблокированного                  | Поддерживает безопасность среды, критично для удержания аудитории                                                    |
| Удалить пользователя                                        | Сохраняет репутацию платформы, борется с нарушениями                                                                 |
| Разблокировать пользователя                                 | Поддерживает лояльность через справедливое отношение                                                                 |
| Пометить комментарий как удаленный                          | Борется со спамом/нарушениями, сохраняет качество среды                                                              |
| Пометить публикацию как удаленную                           | Удаляет некачественный/запрещенный контент                                                                           |
| Отобразить зарегистрированные жалобы                        | Ускоряет реакцию на проблемы, улучшает среду                                                                         |
| Изменить статус жалобы                                      | Обеспечивает прозрачность модерации                                                                                  |
| Создать конкурс                                             | Привлекает новых пользователей и авторов через уникальные активности                                                  |
| Удалить конкурс                                             | Обеспечивает управление мероприятиями                                                                                |
| Исключить участника                                         | Поддерживает честность и репутацию конкурсов                                                                         |
| Сформировать список победителей                             | Ключевой итог для вовлечения участников и зрителей                                                                   |
| Наградить победителей                                       | Мотивирует к участию в будущих конкурсах, привлекает креаторов                                                       |
| **Для цели: Выход на СНГ рынок**                            |                                                                                                                     |
| Настройка параметров рекламы (гео-таргетинг)                | Позволяет таргетировать рекламу на аудиторию СНГ                                                                    |
| Сбор и отображение статистики (по регионам СНГ)             | Обеспечивает анализ эффективности рекламы в целевом регионе                                                          |
| Локализация интерфейса (русский язык)                       | Обязательное условие для работы на рынке СНГ                                                                        |

### От требований заинтересованных лиц к сценариям использования

| Требование заинтересованного лица      | Связанные сценарии использования                          | Обоснование связи                                                                 |
|---------------------------------------|----------------------------------------------------------|-----------------------------------------------------------------------------------|
| **Делать публикации**                 | Пользователь: Создать публикацию                         | Прямая реализация функционала создания контента                                   |
| **Удалять публикацию**                | Пользователь: Удалить публикацию<br>Модератор: Удалить публикацию пользователя | Покрывает удаление как владельцем, так и администратором                         |
| **Получать уведомления**              | *(Не покрыто)*                                          | Требуется новый сценарий (напр. "Обработка уведомлений")                          |
| **Группировать изображения в альбом** | *(Не покрыто)*                                          | Отсутствует сценарий создания/управления альбомами                               |
| **Искать изображения**                | *(Не покрыто)*                                          | Нет сценария поиска контента                                                      |
| **Добавлять в понравившиеся**         | *(Не покрыто)*                                          | Отсутствует сценарий работы с избранным                                           |
| **Скачивать изображение**             | *(Не покрыто)*                                          | Нет сценария загрузки контента                                                    |
| **Пожаловаться на контент**           | *(Не покрыто)*                                          | Требуется сценарий "Отправить жалобу"                                             |
| **Участвовать в конкурсе**            | *(Частично)* Контент-креатор: Создать конкурс           | Нет сценария участия пользователей (только создания конкурсов)                   |
| **Оформлять подписку**                | Пользователь: Оформить подписку                         | Прямая реализация подписки                                                        |
| **Оценивать публикацию**              | *(Не покрыто)*                                          | Нет сценария upvote/рейтинга контента                                             |
| **Иметь аккаунт**                     | Пользователь: Запросить удаление аккаунта               | Частичное покрытие (не хватает регистрации и входа)                              |
| **Поддержать разработчиков**          | *(Не покрыто)*                                          | Нет сценария приема донатов                                                       |
| **Размещать рекламу**                 | Рекламодатель: Разместить рекламу                       | Прямая реализация размещения рекламных материалов                                 |
| **Получать статистику о рекламе**     | Рекламодатель: Отобразить статистику                    | Прямая реализация аналитики рекламных кампаний                                    |
| **Блокировать пользователя**          | Модератор: Заблокировать аккаунт                        | Прямая реализация блокировки аккаунтов                                            |
| **Удалять комментарий (модератор)**   | *(Не покрыто)*                                          | Нет отдельного сценария для комментариев                                          |
| **Просматривать список жалоб**        | *(Не покрыто)*                                          | Нет сценария работы с жалобами                                                    |
| **Проводить конкурсы**                | Контент-креатор: Создать конкурс | Полное покрытие жизненного цикла конкурса                                         |

### От атрибутов качества к архитектурным решениям

1. Доступность (99.95%):
    - Микросервисы: Каждый сервис развертывается в 3+ AZ
    - Redis: Sentinel mode с автоматическим failover
    - API Gateway: Health checks + автоматическое исключение нерабочих нод
    - Пример: При падении Auth-сервиса Gateway перенаправляет запросы на резервный регион

2. Надежность (MTTR ≤15 мин):
    - gRPC: Автоматические retry с экспоненциальным откатом
    - Redis: Async replication + дисковое сохранение данных
    - Метрика: Репликация данных между ЦОД с RPO <1 мин

3. Производительность (500 мс p95):
    - Redis: Кэширование ответов БД (cache-hit ratio >85%)
    - gRPC: Бинарные протоколы (экономия 30-50% vs JSON)
    - SPA: Кэширование статики на CDN (Edge locations
    - Бенчмарк: 1200 RPS на инстанс при 32 vCPU

4. Масштабируемость (1→10 экз.):
    - Микросервисы: Автоскейлинг по CPU/RAM (HPA в Kubernetes)
    - API Gateway: Round-robin балансировка с учетом загрузки
    - Сценарий: Пиковая нагрузка конкурсов → масштабирование Contest Service

5. Расширяемость (3 дня на фичу):
    - Микросервисы: Новая рекомендательная система как отдельный сервис
    - gRPC: Версионирование proto-контрактов
    - Пример: Добавление видео-форматов без изменения core-сервисов

6. Безопасность (OWASP Top 10):
    - External IdP: OAuth 2.0 + MFA + аудит доступа
    - API Gateway: Защита от DDoS, инъекций и XSS
    - Архитектура: Zero-trust сеть между микросервисами (mTLS)
    - Комплаенс: Шифрование PII в Redis (AES-256-GCM)

### Трассировка данных

| Сценарий использования                     | Задействованные сущности              | Операции с данными                                                                 |
|-------------------------------------------|---------------------------------------|-----------------------------------------------------------------------------------|
| **Пользователь: Создать публикацию**      | Пользователь, Публикация, Изображение | Создание: Публикация, Изображение<br>Обновление: Пользователь (статистика)        |
| **Пользователь: Удалить публикацию**      | Пользователь, Публикация, Изображение | Удаление: Публикация<br>Обновление: Изображение (ссылки), Пользователь (статистика)|
| **Пользователь: Оформить подписку**       | Пользователь, Подписка, Тип подписки  | Создание: Подписка<br>Чтение: Тип подписки<br>Обновление: Пользователь (статус)   |
| **Пользователь: Запросить удаление аккаунта** | Пользователь, Подписка, Публикация | Обновление: Пользователь (статус)<br>Удаление: Подписка<br>Каскадное удаление: Публикация |
| **Модератор: Удалить публикацию**         | Модератор, Публикация, Пользователь   | Удаление: Публикация<br>Обновление: Пользователь (репутация)<br>Создание: Уведомление |
| **Модератор: Заблокировать аккаунт**      | Модератор, Пользователь               | Обновление: Пользователь (статус блокировки)<br>Создание: Уведомление             |
| **Контент-креатор: Создать конкурс**      | Контент-креатор, Соревнование         | Создание: Соревнование<br>Обновление: Контент-креатор (активность)                |
| **Контент-креатор: Наградить победителя** | Контент-креатор, Соревнование, Пользователь | Обновление: Соревнование (статус)<br>Обновление: Пользователь (награды)<br>Создание: Уведомление |
| **Рекламодатель: Разместить рекламу**     | Рекламодатель, Реклама                | Создание: Реклама<br>Обновление: Рекламодатель (баланс)                           |
| **Рекламодатель: Отобразить статистику**  | Рекламодатель, Реклама, Пользователь  | Чтение: Реклама (показы, клики)<br>Анализ: Пользователь (демография)              |